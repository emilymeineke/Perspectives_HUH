RA_dframe$binary_SM <- ifelse(RA_dframe$sooty.mould>0, 1, 0)
RA_dframe$binary_lgalls <- ifelse(RA_dframe$leaf.galls>0, 1, 0)
RA_dframe$binary_blotchmines <- ifelse(RA_dframe$blotch.mine>0, 1, 0)
RA_dframe$binary_serpmines <- ifelse(RA_dframe$serpentine.mine>0, 1, 0)
RA_dframe_resh2 <- melt(RA_dframe, id.vars=c("plant_genus_species", "taxon", "MF", "abscission_num",
"herbarium", "date", "month", "month_cat", "day", "year", "doy",
"state", "phenology", "county", "X1", "X2"))
RA_dframe_resh2_fig2 <- subset(RA_dframe_resh2, variable== "binary_noherbiv"|variable=="binary_chew"|variable=="binary_stipp"|variable=="binary_lmines"|
variable=="binary_SM"|variable=="binary_lgalls"|variable=="binary_skel")
mar <- subset(RA_dframe_resh2_fig2, month_cat=="March")
apr <- subset(RA_dframe_resh2_fig2, month_cat=="April")
may <- subset(RA_dframe_resh2_fig2, month_cat=="May")
jun <- subset(RA_dframe_resh2_fig2, month_cat=="June")
jul <- subset(RA_dframe_resh2_fig2, month_cat=="July")
aug <- subset(RA_dframe_resh2_fig2, month_cat=="August")
sept <- subset(RA_dframe_resh2_fig2, month_cat=="September")
oct <- subset(RA_dframe_resh2_fig2, month_cat=="October")
#Plot
cat <- ggplot(RA_dframe_resh2_fig2, aes(value))
cat <- cat + geom_bar(aes(fill = variable), position = "fill")
cat
RA_dframe_resh2_fig2$value <- as.numeric(RA_dframe_resh2_fig2$value)
x <- nrow(RA_dframe_resh2_fig2)
RA_dframe_fig2_noNA <- subset(RA_dframe_resh2_fig2, value != "NA")
RA_dframe_fig2_noNA$prop <- RA_dframe_fig2_noNA$value/4908
RA_dframe_fig2_noNA <- subset(RA_dframe_fig2_noNA, month_cat != "March" & month_cat != "December")
cat <- ggplot(RA_dframe_fig2_noNA, aes(x=reorder(month_cat,doy), y=prop)) + xlab("") + ylab("Proportion of specimens")
cat <- cat + geom_bar(aes(fill = variable), position = "fill", stat="identity") + scale_fill_manual(values=cbPalette,
name="Damage Type",
breaks=c("binary_chew", "binary_skel", "binary_stipp", "binary_lgalls", "binary_lmines", "binary_noherbiv"),
labels=c("Chewing (leaf area removed)", "Skeletonization", "Stippling", "Leaf Galls", "Leaf mines", "No herbivory"))
cat
#Overall test for effect of year, doy
RA_dframe_noNAchew <- subset(RA_dframe, ch_leafremoved != "NA")
RA_dframe_noNAchew$totalboxes <- 5
RA_dframe_noNAchew$chew_prop <- RA_dframe_noNAchew$ch_leafremoved/RA_dframe_noNAchew$totalboxes
model <- glmer(chew_prop~log(doy+1)+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=RA_dframe_noNAchew, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
#Figure 4: NMDS
#Construct matrix
RA_dframe_sub <- RA_dframe
RA_dframe_sub$Total <- ch_leafremoved+skel+stippling+blotch.mine+serpentine.mine+leafminer.oviholes+leaf.galls+leaf.roller
RA_dframe_sub <- subset(RA_dframe_sub, Total != "NA" & Total != 0)
mat <- RA_dframe_sub[,15:27]
matID <- 1:nrow(mat)
mat <- cbind(mat, matID)
RA_dframe_sub <- cbind(matID, RA_dframe_sub)
mat <- mat[c("matID", "ch_leafremoved", "skel",    "stippling", "blotch.mine", "serpentine.mine",
"leafminer.oviholes", "leaf.galls", "leaf.roller")]
mat <- as.matrix(mat)
#Make map
map <- RA_dframe_sub[c("matID", "plant_genus_species", "taxon", "MF", "abscission_num", "herbarium",
"date", "month", "month_cat", "day", "year", "doy", "state", "phenology", "county" )]
#nmds-- not enough data
otu.bray <- vegdist(t(mat),method="bray")
braycurtis.mds <- metaMDS(otu.bray, k=2)
with(map, levels(plant_genus_species))
stressplot(braycurtis.mds)
colvec <- c("black","lawngreen","royalblue1","red2", "yellow", "darkblue","green","purple","orange",
"red1", "darkgreen","blue", "red", "brown","beige", "azure","cadetblue4", "chocolate4", "aliceblue", "coral3")
#jpeg(file="/Users/emilymeineke/Desktop/Collaborations/Ant nest microbes/Bact results/Taxa_NMDS_bact.jpg")
plot(braycurtis.mds)
RA_dframe_sub <- subset(RA_dframe_sub, Total != "NA" & Total != 0)
#Figure 4: NMDS
#Construct matrix
RA_dframe_sub <- RA_dframe
RA_dframe_sub$Total <- ch_leafremoved+skel+stippling+blotch.mine+serpentine.mine+leafminer.oviholes+leaf.galls+leaf.roller
RA_dframe_sub <- subset(RA_dframe_sub, Total != "NA" & Total != 0)
mat <- RA_dframe_sub[,15:27]
matID <- 1:nrow(mat)
mat <- cbind(mat, matID)
RA_dframe_sub <- cbind(matID, RA_dframe_sub)
mat <- mat[c("matID", "ch_leafremoved", "skel",    "stippling", "blotch.mine", "serpentine.mine",
"leafminer.oviholes", "leaf.galls", "leaf.roller")]
mat <- as.matrix(mat)
map <- RA_dframe_sub[c("matID", "plant_genus_species", "taxon", "MF", "abscission_num", "herbarium",
"date", "month", "month_cat", "day", "year", "doy", "state", "phenology", "county" )]
otu.bray <- vegdist(t(mat),method="bray")
View(RA_dframe_sub)
range(RA_dframe_sub$Total)
RA_dframe_sub$Total <- ch_leafremoved+skel+stippling+blotch.mine+serpentine.mine+leafminer.oviholes+leaf.galls+leaf.roller
RA_dframe_sub <- RA_dframe
RA_dframe_sub$Total <- ch_leafremoved+skel+stippling+blotch.mine+serpentine.mine+leafminer.oviholes+leaf.galls+leaf.roller
RA_dframe_sub <- subset(RA_dframe_sub, Total != "NA" & Total != 0)
mat <- RA_dframe_sub[,15:27]
View(mat)
mat <- RA_dframe_sub[,15:25]
View(mat)
mat <- RA_dframe_sub[,15:25]
matID <- 1:nrow(mat)
mat <- cbind(mat, matID)
RA_dframe_sub <- cbind(matID, RA_dframe_sub)
mat <- mat[c("matID", "ch_leafremoved", "skel",    "stippling", "blotch.mine", "serpentine.mine",
"leafminer.oviholes", "leaf.galls", "leaf.roller")]
mat <- as.matrix(mat)
View(mat)
#Make map
map <- RA_dframe_sub[c("matID", "plant_genus_species", "taxon", "MF", "abscission_num", "herbarium",
"date", "month", "month_cat", "day", "year", "doy", "state", "phenology", "county" )]
#nmds-- not enough data
otu.bray <- vegdist(t(mat),method="bray")
braycurtis.mds <- metaMDS(otu.bray, k=2)
with(map, levels(plant_genus_species))
stressplot(braycurtis.mds)
RA_dframe_sub <- RA_dframe
RA_dframe_sub$Total <- ch_leafremoved+skel+stippling+blotch.mine+serpentine.mine+leafminer.oviholes+leaf.galls+leaf.roller
RA_dframe_sub <- subset(RA_dframe_sub, Total != "NA" & Total != 0)
mat <- RA_dframe_sub[,15:25]
matID <- 1:nrow(mat)
mat <- cbind(mat, matID)
RA_dframe_sub <- cbind(matID, RA_dframe_sub)
mat <- mat[c("matID", "ch_leafremoved", "skel",    "stippling", "blotch.mine", "serpentine.mine",
"leafminer.oviholes", "leaf.galls", "leaf.roller")]
mat <- as.matrix(mat)
View(mat)
RA_dframe_sub <- RA_dframe
RA_dframe_sub$Total <- ch_leafremoved+skel+stippling+blotch.mine+serpentine.mine+leafminer.oviholes+leaf.galls+leaf.roller
RA_dframe_sub <- subset(RA_dframe_sub, Total != "NA" & Total != 0)
mat <- RA_dframe_sub[,15:25]
matID <- 1:nrow(mat)
mat <- cbind(mat, matID)
RA_dframe_sub <- cbind(matID, RA_dframe_sub)
mat <- mat[c("matID", "ch_leafremoved", "skel",    "stippling", "blotch.mine", "serpentine.mine",
"leafminer.oviholes", "leaf.galls")]
mat <- as.matrix(mat)
View(mat)
sum(RA_dframe_sub$serpentine.mine)
sum(RA_dframe_sub$leafminer.oviholes)
RA_dframe_sub <- RA_dframe
RA_dframe_sub$Total <- ch_leafremoved+skel+stippling+blotch.mine+serpentine.mine+leafminer.oviholes+leaf.galls+leaf.roller
RA_dframe_sub <- subset(RA_dframe_sub, Total != "NA" & Total != 0)
mat <- RA_dframe_sub[,15:25]
matID <- 1:nrow(mat)
mat <- cbind(mat, matID)
RA_dframe_sub <- cbind(matID, RA_dframe_sub)
mat <- mat[c("matID", "ch_leafremoved", "skel",    "stippling", "blotch.mine", "serpentine.mine",
"leafminer.oviholes", "leaf.galls")]
mat <- as.matrix(mat)
map <- RA_dframe_sub[c("matID", "plant_genus_species", "taxon", "MF", "abscission_num", "herbarium",
"date", "month", "month_cat", "day", "year", "doy", "state", "phenology", "county" )]
#nmds-- not enough data
otu.bray <- vegdist(t(mat),method="bray")
braycurtis.mds <- metaMDS(otu.bray, k=2)
with(map, levels(plant_genus_species))
stressplot(braycurtis.mds)
colvec <- c("black","lawngreen","royalblue1","red2", "yellow", "darkblue","green","purple","orange",
"red1", "darkgreen","blue", "red", "brown","beige", "azure","cadetblue4", "chocolate4", "aliceblue", "coral3")
#jpeg(file="/Users/emilymeineke/Desktop/Collaborations/Ant nest microbes/Bact results/Taxa_NMDS_bact.jpg")
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
braycurtis.mds <- metaMDS(otu.bray, k=3)
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
#dev.off()
map
View(map)
View(mat)
braycurtis.mds
braycurtis.mds <- metaMDS(otu.bray, k=2)
species.scores(braycurtis.mds)
scores(braycurtis.mds)
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="species", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
#dev.off()
otu.bray <- vegdist(mat,method="bray")
braycurtis.mds <- metaMDS(otu.bray, k=2)
with(map, levels(plant_genus_species))
stressplot(braycurtis.mds)
colvec <- c("black","lawngreen","royalblue1","red2", "yellow", "darkblue","green","purple","orange",
"red1", "darkgreen","blue", "red", "brown","beige", "azure","cadetblue4", "chocolate4", "aliceblue", "coral3")
#jpeg(file="/Users/emilymeineke/Desktop/Collaborations/Ant nest microbes/Bact results/Taxa_NMDS_bact.jpg")
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
otu.bray <- vegdist(mat,method="bray")
braycurtis.mds <- metaMDS(otu.bray, k=3)
with(map, levels(plant_genus_species))
stressplot(braycurtis.mds)
colvec <- c("black","lawngreen","royalblue1","red2", "yellow", "darkblue","green","purple","orange",
"red1", "darkgreen","blue", "red", "brown","beige", "azure","cadetblue4", "chocolate4", "aliceblue", "coral3")
#jpeg(file="/Users/emilymeineke/Desktop/Collaborations/Ant nest microbes/Bact results/Taxa_NMDS_bact.jpg")
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
#dev.off()
mean_damage <- ddply(RA_dframe, ~plant_genus_species, summarize, mean_damtypes = mean(total_damtypes, na.rm=T))
View(mean_damage)
View(RA_dframe)
View(mean_damage)
mean_damage <- sort(mean_damage, by="mean_damtypes")
mean_damage <- sort(mean_damage, mean_damage$mean_damtypes)
mean_damage
?sort
mean_damage <- sort(mean_damage)
mean_damage <- sort(mean_damage$mean_damtypes)
mean_damage <- ddply(RA_dframe, ~plant_genus_species, summarize, mean_damtypes = mean(total_damtypes, na.rm=T))
mean_damage <- sort(mean_damage, by=mean_damtypes)
mean_damage <- sort(mean_damage, by="mean_damtypes")
RA_dframe
mean_damage <- ddply(RA_dframe, ~plant_genus_species, summarize, mean_damtypes = mean(total_damtypes, na.rm=T))
mean_damage
mean_damage_abv1 <- subset(mean_damage, mean_damtypes >1)
mean_damage_abv1
ggplot(RA_dframe, aes(y=mean_damtypes, x=doy, colour=plant_genus_species)) + geom_point()
ggplot(RA_dframe, aes(y=damdiv_prop, x=doy, colour=plant_genus_species)) + geom_point()
RA_dframe_sub1 <- subset(RA_dframe, plant_genus_species == "epigaea_repens"|plant_genus_species=="lespedeza_hirta")
ggplot(RA_dframe_sub1, aes(y=damdiv_prop, x=doy, colour=plant_genus_species)) + geom_point()
RA_dframe_sub1 <- subset(RA_dframe, plant_genus_species == "epigaea_repens"|plant_genus_species=="lespedeza_hirta"|plant_genus_species=="lespedeza_capitata")
ggplot(RA_dframe_sub1, aes(y=damdiv_prop, x=doy, colour=plant_genus_species)) + geom_point()
#Continuous, garbage
Fig3_cont <- ggplot(topfive_RA_dframe_resh, aes(x=doy, y=value, colour=plant_genus_species))
Fig3_cont <- Fig3_cont +  geom_point() +ylim(0,5) +theme_bw() +xlab("day of year") + ylab("cells with herbivore damage")
Fig3_cont
#Get incidence of chewing herbivory for all species
#Plot how chewing herbivory changes over season for all species
levels(RA_dframe$plant_genus_species)
BATI <- subset(RA_dframe, plant_genus_species == "baptisia_tinctoria")
CLAL <- subset(RA_dframe, plant_genus_species == "clethra_alnifolia")
CORA <- subset(RA_dframe, plant_genus_species == "cornus_racemosa")
EPRE <- subset(RA_dframe, plant_genus_species == "epigaea_repens")
GATR <- subset(RA_dframe, plant_genus_species == "galium_triflorum")
GABA <- subset(RA_dframe, plant_genus_species == "gaylussacia_baccata")
KAAN <- subset(RA_dframe, plant_genus_species == "kalmia_angustifolia")
LEIN <- subset(RA_dframe, plant_genus_species == "lechea_intermedia")
LECA <- subset(RA_dframe, plant_genus_species == "lespedeza_capitata")
LEHI <- subset(RA_dframe, plant_genus_species == "lespedeza_hirta")
LUPA <- subset(RA_dframe, plant_genus_species == "ludwigia_palustris")
LYAM <- subset(RA_dframe, plant_genus_species == "lycopus_americanus")
LYTE <- subset(RA_dframe, plant_genus_species == "lysimachia_terrestris")
MEAR <- subset(RA_dframe, plant_genus_species == "mentha_arvensis")
POSA <- subset(RA_dframe, plant_genus_species == "polygala_sanguinea")
TRVI <- subset(RA_dframe, plant_genus_species == "triadenum_virginicum")
VAMA <- subset(RA_dframe, plant_genus_species == "vaccinium_macrocarpon")
VIBL <- subset(RA_dframe, plant_genus_species == "viola_blanda")
VICU <- subset(RA_dframe, plant_genus_species == "viola_cucullata")
VILA <- subset(RA_dframe, plant_genus_species == "vitis_labrusca")
#Plots of chewing abundance by doy by species
plo <- ggplot(BATI, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(CLAL, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
RA_dframe$totalherbiv <- RA_dframe$chewing_tot+RA_dframe$stippling+RA_dframe$leafmines_tot+RA_dframe$sooty.mould+RA_dframe$leaf.galls
RA_dframe$binary_noherbiv <- ifelse(RA_dframe$totalherbiv>0, 1, 0)
RA_dframe$binary_chew<- ifelse(RA_dframe$ch_leafremoved>0, 1, 0)
RA_dframe$binary_skel <- ifelse(RA_dframe$skel>0, 1, 0)
RA_dframe$binary_stipp <- ifelse(RA_dframe$stippling>0, 1, 0)
RA_dframe$binary_lmines <- ifelse(RA_dframe$leafmines_tot>0, 1, 0)
RA_dframe$binary_SM <- ifelse(RA_dframe$sooty.mould>0, 1, 0)
RA_dframe$binary_lgalls <- ifelse(RA_dframe$leaf.galls>0, 1, 0)
RA_dframe$binary_blotchmines <- ifelse(RA_dframe$blotch.mine>0, 1, 0)
RA_dframe$binary_serpmines <- ifelse(RA_dframe$serpentine.mine>0, 1, 0)
RA_dframe_resh2 <- melt(RA_dframe, id.vars=c("plant_genus_species", "taxon", "MF", "abscission_num",
"herbarium", "date", "month", "month_cat", "day", "year", "doy",
"state", "phenology", "county", "X1", "X2"))
RA_dframe_resh2_fig2 <- subset(RA_dframe_resh2, variable== "binary_noherbiv"|variable=="binary_chew"|variable=="binary_stipp"|variable=="binary_lmines"|
variable=="binary_SM"|variable=="binary_lgalls"|variable=="binary_skel")
mar <- subset(RA_dframe_resh2_fig2, month_cat=="March")
apr <- subset(RA_dframe_resh2_fig2, month_cat=="April")
may <- subset(RA_dframe_resh2_fig2, month_cat=="May")
jun <- subset(RA_dframe_resh2_fig2, month_cat=="June")
jul <- subset(RA_dframe_resh2_fig2, month_cat=="July")
aug <- subset(RA_dframe_resh2_fig2, month_cat=="August")
sept <- subset(RA_dframe_resh2_fig2, month_cat=="September")
oct <- subset(RA_dframe_resh2_fig2, month_cat=="October")
#Plot
cat <- ggplot(RA_dframe_resh2_fig2, aes(value))
cat <- cat + geom_bar(aes(fill = variable), position = "fill")
cat
RA_dframe_resh2_fig2$value <- as.numeric(RA_dframe_resh2_fig2$value)
x <- nrow(RA_dframe_resh2_fig2)
RA_dframe_fig2_noNA <- subset(RA_dframe_resh2_fig2, value != "NA")
RA_dframe_fig2_noNA$prop <- RA_dframe_fig2_noNA$value/4908
RA_dframe_fig2_noNA <- subset(RA_dframe_fig2_noNA, month_cat != "March" & month_cat != "December")
cat <- ggplot(RA_dframe_fig2_noNA, aes(x=reorder(month_cat,doy), y=prop)) + xlab("") + ylab("Proportion of specimens")
cat <- cat + geom_bar(aes(fill = variable), position = "fill", stat="identity") + scale_fill_manual(values=cbPalette,
name="Damage Type",
breaks=c("binary_chew", "binary_skel", "binary_stipp", "binary_lgalls", "binary_lmines", "binary_noherbiv"),
labels=c("Chewing (leaf area removed)", "Skeletonization", "Stippling", "Leaf Galls", "Leaf mines", "No herbivory"))
cat
mean_damage_abund <- ddply(RA_dframe, ~plant_genus_species, summarize, mean_chewing = mean(ch_leafremoved, na.rm=T))
View(mean_damage_abund)
plo <- ggplot(EPRE, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
mean_damage_abund_top
#Identify species with most chewing damage
mean_damage_abund
plo <- ggplot(CLAL, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(CORA, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(LEHI, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(KAAN, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
mean_damage_abund_top <- mean_damage_abund[order(mean_chewing),]
mean_damage_abund <- ddply(RA_dframe, ~plant_genus_species, summarize, mean_chewing = mean(ch_leafremoved, na.rm=T))
attach(mean_damage_abund)
mean_damage_abund_top <- mean_damage_abund[order(mean_chewing),]
View(mean_damage_abund_top)
model <- glmer(chew_prop~log(doy+1)+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=RA_dframe_noNAchew, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
summary(binary_chew[[2]])
otu.bray <- vegdist(t(mat),method="bray")
braycurtis.mds <- metaMDS(otu.bray, k=3)
braycurtis.mds <- metaMDS(otu.bray, k=2)
with(map, levels(plant_genus_species))
stressplot(braycurtis.mds)
colvec <- c("black","lawngreen","royalblue1","red2", "yellow", "darkblue","green","purple","orange",
"red1", "darkgreen","blue", "red", "brown","beige", "azure","cadetblue4", "chocolate4", "aliceblue", "coral3")
#jpeg(file="/Users/emilymeineke/Desktop/Collaborations/Ant nest microbes/Bact results/Taxa_NMDS_bact.jpg")
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
braycurtis.mds
scores(braycurtis.mds)
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="species", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
#dev.off()
t(mat)
head(mat)
RA_dframe_sub <- RA_dframe
RA_dframe_sub$Total <- ch_leafremoved+skel+stippling+blotch.mine+serpentine.mine+leafminer.oviholes+leaf.galls+leaf.roller
RA_dframe_sub <- subset(RA_dframe_sub, Total != "NA" & Total != 0)
mat <- RA_dframe_sub[,15:25]
matID <- 1:nrow(mat)
mat <- cbind(mat, matID)
RA_dframe_sub <- cbind(matID, RA_dframe_sub)
mat <- mat[c("ch_leafremoved", "skel",    "stippling", "blotch.mine", "serpentine.mine",
"leafminer.oviholes", "leaf.galls")]
mat <- as.matrix(mat)
map <- RA_dframe_sub[c("matID", "plant_genus_species", "taxon", "MF", "abscission_num", "herbarium",
"date", "month", "month_cat", "day", "year", "doy", "state", "phenology", "county" )]
#nmds-- not enough data
otu.bray <- vegdist(t(mat),method="bray")
braycurtis.mds <- metaMDS(otu.bray, k=2)
with(map, levels(plant_genus_species))
stressplot(braycurtis.mds)
colvec <- c("black","lawngreen","royalblue1","red2", "yellow", "darkblue","green","purple","orange",
"red1", "darkgreen","blue", "red", "brown","beige", "azure","cadetblue4", "chocolate4", "aliceblue", "coral3")
#jpeg(file="/Users/emilymeineke/Desktop/Collaborations/Ant nest microbes/Bact results/Taxa_NMDS_bact.jpg")
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
#dev.off()
otu.bray <- vegdist(mat,method="bray")
braycurtis.mds <- metaMDS(otu.bray, k=2)
View(mat)
View(mat)
with(map, levels(plant_genus_species))
stressplot(braycurtis.mds)
colvec <- c("black","lawngreen","royalblue1","red2", "yellow", "darkblue","green","purple","orange",
"red1", "darkgreen","blue", "red", "brown","beige", "azure","cadetblue4", "chocolate4", "aliceblue", "coral3")
#jpeg(file="/Users/emilymeineke/Desktop/Collaborations/Ant nest microbes/Bact results/Taxa_NMDS_bact.jpg")
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
fotu.bray <- vegdist(mat,method="bray")
fad<-adonis(fotu.bray~plant_genus_species, data=map, permutations=999)
fad
fmod<-with(meta1,betadisper(fotu.bray,plant_genus_species))
fmod<-with(map,betadisper(fotu.bray,plant_genus_species))
anova(fmod)
TukeyHSD(fmod)
scores(braycurtis.mds)
map <- cbind(map, scores(braycurtis.mds))
View(map)
map <- cbind(map, mat)
View(mat)
View(mat)
RA_dframe_sub <- RA_dframe
RA_dframe_sub$Total <- ch_leafremoved+skel+stippling+blotch.mine+serpentine.mine+leafminer.oviholes+leaf.galls+leaf.roller
RA_dframe_sub <- subset(RA_dframe_sub, Total != "NA" & Total != 0)
#Get rid of outlier with 4 leaf galls
RA_dframe_sub <- subset(RA_dframe_sub, leaf.galls<4)
mat <- RA_dframe_sub[,15:25]
matID <- 1:nrow(mat)
mat <- cbind(mat, matID)
RA_dframe_sub <- cbind(matID, RA_dframe_sub)
mat <- mat[c("ch_leafremoved", "skel",    "stippling", "blotch.mine", "serpentine.mine",
"leafminer.oviholes", "leaf.galls")]
mat <- as.matrix(mat)
#Make map
map <- RA_dframe_sub[c("matID", "plant_genus_species", "taxon", "MF", "abscission_num", "herbarium",
"date", "month", "month_cat", "day", "year", "doy", "state", "phenology", "county" )]
#nmds
otu.bray <- vegdist(mat,method="bray")
braycurtis.mds <- metaMDS(otu.bray, k=2)
with(map, levels(plant_genus_species))
stressplot(braycurtis.mds)
colvec <- c("black","lawngreen","royalblue1","red2", "yellow", "darkblue","green","purple","orange",
"red1", "darkgreen","blue", "red", "brown","beige", "azure","cadetblue4", "chocolate4", "aliceblue", "coral3")
#jpeg(file="/Users/emilymeineke/Desktop/Collaborations/Ant nest microbes/Bact results/Taxa_NMDS_bact.jpg")
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
plot(jitter(braycurtis.mds))
fotu.bray <- vegdist(mat,method="bray")
fad<-adonis(fotu.bray~plant_genus_species, data=map, permutations=999)
fad
fmod<-with(map,betadisper(fotu.bray,plant_genus_species))
anova(fmod)
braycurtis.mds
dim(scores(braycurtis.mds))
joined <- cbind(map, mat, scores(braycurtis.mds))
View(joined)
otu.bray <- vegdist(mat,method="bray")
braycurtis.mds <- metaMDS(otu.bray, k=2)
with(map, levels(plant_genus_species))
stressplot(braycurtis.mds)
colvec <- c("black","lawngreen","royalblue1","grey", "yellow", "darkblue","green","purple","orange",
"red1", "darkgreen","blue", "darkturquoise", "brown","darkslategrey", "azure","cadetblue4", "chocolate4", "aliceblue", "tomato2")
#jpeg(file="/Users/emilymeineke/Desktop/Collaborations/Ant nest microbes/Bact results/Taxa_NMDS_bact.jpg")
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
colvec <- c("black","lawngreen","royalblue1","grey", "yellow", "darkblue","green","purple","orange",
"red1", "darkgreen","blue", "darkturquoise", "brown","darkslategrey", "azure","cadetblue4", "chocolate4", "aliceblue", "tomato2")
#
colvec
colvec <- c("black","lawngreen","royalblue1","grey", "yellow", "darkblue","green","purple","orange",
"red1", "darkgreen","blue", "darkturquoise", "brown","darkslategrey", "azure","cadetblue4",
"chocolate4", "aliceblue", "violetred2")
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
colvec <- c("black","lawngreen","royalblue1","grey", "yellow", "darkblue","green","purple","orange",
"red1", "darkgreen","blue", "darkturquoise", "brown","darkslategrey", "springgreen1","cadetblue4",
"chocolate4", "aliceblue", "violetred2")
#jpeg(file="/Users/emilymeineke/Desktop/Collaborations/Ant nest microbes/Bact
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
colvec <- c("black","lawngreen","royalbluenavy","grey", "yellow", "darkblue","green","purple","orange",
"red1", "darkgreen","skyblue", "darkturquoise", "brown","darkslategrey", "springgreen1","cadetblue4",
"chocolate4", "aliceblue", "violetred2")
#jpeg(file="/Users/emilymeineke/Desktop/Collaborations/Ant nest microbes/Bact results/Taxa_NMDS_bact.jpg")
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
colvec <- c("black","lawngreen","navybluenavy","grey", "yellow", "darkblue","green","purple","orange",
"red1", "darkgreen","skyblue", "darkturquoise", "brown","darkslategrey", "springgreen1","cadetblue4",
"chocolate4", "aliceblue", "violetred2")
#jpeg(file="/Users/emilymeineke/Desktop/Collaborations/Ant nest microbes/Bact results/Taxa_NMDS_bact.jpg")
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
#dev.off()
colvec <- c("black","lawngreen","navy","grey", "yellow", "darkblue","green","purple","orange",
"red1", "darkgreen","skyblue", "darkturquoise", "brown","darkslategrey", "springgreen1","cadetblue4",
"chocolate4", "aliceblue", "violetred2")
#jpeg(file="/Users/emilymeineke/Desktop/Collaborations/Ant nest microbes/Bact results/Taxa_NMDS_bact.jpg")
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
#dev.off()
colvec <- c("black","lawngreen","navy","grey", "yellow", "darkblue","green","purple","orange",
"red1", "darkgreen","skyblue", "darkturquoise", "brown","darkslategrey", "springgreen1","cadetblue4",
"chocolate4", "palegoldenrod", "violetred2")
#jpeg(file="/Users/emilymeineke/Desktop/Collaborations/Ant nest microbes/Bact results/Taxa_NMDS_bact.jpg")
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
#dev.off()
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("right",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
#dev.off()
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
#dev.off()
View(aug)
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
#dev.off()
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("bottomright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
#dev.off()
plot(braycurtis.mds)
with(map, points(braycurtis.mds, display="sites", col=colvec[plant_genus_species], pch=21, bg=colvec[plant_genus_species]))
with(map, legend("topright",legend=levels(plant_genus_species),bty="n", col=colvec, pch=21, pt.bg=colvec))
#dev.off()
RA_dframe_resh$binary <- ifelse(RA_dframe_resh$value>0, 1, 0)
topfive <- ddply(RA_dframe_resh, ~variable, summarize, mean_specdamaged = mean(binary, na.rm=T))
topfive <- topfive[order(-topfive$mean_specdamaged),]
#topfive = chewing_tot, stippling, sooty.mould, leafmines_tot, leaf.galls
topfive_RA_dframe_resh <- subset(RA_dframe_resh, variable=="ch_leafremoved"|variable=="skel"|variable=="stippling"|variable=="sooty.mould"|variable=="leafmines_tot"|variable=="leaf.galls")
#Freqency poly
cbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
Fig2 <- ggplot(topfive_RA_dframe_resh, aes(value, colour=variable))
Fig2 <- Fig2 +  geom_freqpoly(binwidth = 1, size=1.3) +xlim(0,5) +theme_bw() +xlab("Grid cells with herbivory") + ylab("Specimens") + scale_colour_manual(values=cbPalette,
name="Damage Type",
breaks=c("ch_leafremoved", "skel", "stippling", "leaf.galls", "sooty.mould", "leafmines_tot"),
labels=c("Chewing (leaf area removed)", "Skeletonization", "Stippling", "Leaf Galls", "Sooty Mould", "Leaf mines"))
Fig2
#Histogram
cbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
hist_cut <- ggplot(topfive_RA_dframe_resh, aes(x=value, fill=variable)) +xlab("Grid cells with herbivory") + ylab("Specimens")
hist_cut <- hist_cut + geom_bar(position="dodge") + theme_bw() + scale_fill_manual(values=cbPalette,
name="Damage Type",
breaks=c("ch_leafremoved", "skel", "stippling", "leaf.galls", "sooty.mould", "leafmines_tot"),
labels=c("Chewing (leaf area removed)", "Skeletonization", "Stippling", "Leaf Galls", "Sooty Mould", "Leaf mines"))
hist_cut
