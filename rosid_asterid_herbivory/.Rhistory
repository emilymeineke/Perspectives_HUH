Fig2_cont <- ggplot(topfive_RA_dframe_resh, aes(x=doy, y=value, colour=plant_genus_species))
Fig2_cont <- Fig2_cont +  geom_point() +ylim(0,5) +theme_bw() +xlab("day of year") + ylab("cells with herbivore damage") +geom_abline()
Fig2_cont
Fig2_cat <- ggplot(topfive_RA_dframe_resh, aes(x=month, y=value, colour=plant_genus_species))
Fig2_cat <- Fig2_cat +  geom_bar() +ylim(0,5) +theme_bw() +xlab("day of year") + ylab("cells with herbivore damage")
Fig2_cat
Fig2_cat <- ggplot(topfive_RA_dframe_resh, aes(x=month, y=value, colour=plant_genus_species))
Fig2_cat <- Fig2_cat +  geom_bar(stat=identity) +ylim(0,5) +theme_bw() +xlab("day of year") + ylab("cells with herbivore damage")
Fig2_cat
Fig2_cat <- ggplot(topfive_RA_dframe_resh, aes(x=month, y=value, colour=plant_genus_species))
Fig2_cat <- Fig2_cat +  geom_bar(stat="identity") +ylim(0,5) +theme_bw() +xlab("day of year") + ylab("cells with herbivore damage")
Fig2_cat
Fig2_cat <- ggplot(topfive_RA_dframe_resh, aes(x=month, y=value, fill=plant_genus_species))
Fig2_cat <- Fig2_cat +  geom_bar(stat="identity") +ylim(0,5) +theme_bw() +xlab("day of year") + ylab("cells with herbivore damage")
Fig2_cat
Fig2_cat <- ggplot(topfive_RA_dframe_resh, aes(x=month, y=value, fill=plant_genus_species))
Fig2_cat <- Fig2_cat +  geom_bar(stat="identity") +theme_bw() +xlab("day of year") + ylab("cells with herbivore damage")
Fig2_cat
Fig2_cat <- ggplot(topfive_RA_dframe_resh, aes(x=month, y=value, fill=plant_genus_species))
Fig2_cat <- Fig2_cat +  geom_bar(stat="identity") +theme_bw() +xlab("month") + ylab("cells with herbivore damage") + scale_x_discrete()
Fig2_cat
levels(RA_dframe_resh$month)
View(topfive_RA_dframe_resh)
values(topfive_RA_dframe_resh$month)
range(topfive_RA_dframe_resh$month)
topfive_RA_dframe_resh_gseason <- subset(topfive_RA_dframe_resh, month<10)
topfive_RA_dframe_resh_gseason <- subset(topfive_RA_dframe_resh, month<10)
Fig2_cat <- ggplot(topfive_RA_dframe_resh, aes(x=month, y=value, fill=plant_genus_species))
Fig2_cat <- Fig2_cat +  geom_bar(stat="identity") +theme_bw() +xlab("month") + ylab("cells with herbivore damage") +
scale_x_discrete("month", labels = c("3" = "Mar","4" = "Apr",
"5" = "May","6" = "Jun","7" = "Jul", "8"="Aug", "9"="Sept"))
Fig2_cat
is.numeric(topfive_RA_dframe_resh$month)
topfive_RA_dframe_resh_gseason <- subset(topfive_RA_dframe_resh, month<10)
Fig2_cat <- ggplot(topfive_RA_dframe_resh, aes(x=month, y=value, fill=plant_genus_species))
Fig2_cat <- Fig2_cat +  geom_bar(stat="identity") +theme_bw() + ylab("cells with herbivore damage") +
scale_x_discrete("month", labels = c("3" = "Mar","4" = "Apr", "5" = "May","6" = "Jun","7" = "Jul", "8"="Aug", "9"="Sept"))
Fig2_cat
range(topfive_RA_dframe_resh_gseason)
topfive_RA_dframe_resh_gseason$month)
range(topfive_RA_dframe_resh_gseason$month)
Fig2_cat <- ggplot(topfive_RA_dframe_resh, aes(x=month, y=value, fill=plant_genus_species))
Fig2_cat <- Fig2_cat +  geom_bar(stat="identity") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
names(RA_dframe)
RA_dframe$totalherbiv <- sum(RA_dframe$chewing_tot, RA_dframe$stippling, RA_dframe$leafmines_tot, RA_dframe$leaf.galls, RA_dframe$sooty.mould,
RA_dframe$leafminer.oviholes, RA_dframe$leaf.roller)
RA_dframe$totalherbiv <- sum(RA_dframe$chewing_tot, RA_dframe$stippling, RA_dframe$leafmines_tot, RA_dframe$leaf.galls, RA_dframe$sooty.mould,
RA_dframe$leafminer.oviholes, RA_dframe$leaf.roller)
RA_dframe$binary_noherbiv <- ifelse(RA_dframe$totalherbiv>0, 1, 0)
View(RA_dframe)
RA_dframe$totalherbiv <- sum(RA_dframe$chewing_tot, RA_dframe$stippling, RA_dframe$leafmines_tot, RA_dframe$leaf.galls, RA_dframe$sooty.mould,
RA_dframe$leafminer.oviholes, RA_dframe$leaf.roller, na.rm=T)
View(RA_dframe)
RA_dframe$totalherbiv <- RA_dframe$chewing_tot+RA_dframe$stippling
View(RA_dframe)
RA_dframe$totalherbiv <- RA_dframe$chewing_tot+RA_dframe$stippling+RA_dframe$leafmines_tot+RA_dframe$leaf.galls+RA_dframe$sooty.mould+
RA_dframe$leafminer.oviholes+RA_dframe$leaf.roller
View(RA_dframe)
names(RA_dframe)
RA_dframe$totalherbiv <- RA_dframe$chewing_tot+RA_dframe$stippling+RA_dframe$leafmines_tot
View(RA_dframe)
View(RA_dframe)
library(ggplot2)
library(reshape2)
library(plyr)
RA_dframe <- read.csv("rosid_asterid_data.csv")
names(RA_dframe)
attach(RA_dframe)
RA_dframe$leafmines_tot <- RA_dframe$serpentine.mine+RA_dframe$blotch.mine
RA_dframe$chewing_tot <- RA_dframe$ch_leafremoved+RA_dframe$skel
#melt into individual rows
RA_dframe_resh <- melt(RA_dframe, id.vars=c("plant_genus_species", "taxon", "MF", "abscission_num",
"herbarium", "date", "month", "day", "year", "doy",
"state", "phenology", "county"))
names(RA_dframe_resh)
RA_dframe$totalherbiv <- RA_dframe$chewing_tot+RA_dframe$stippling+RA_dframe$leafmines_tot
View(RA_dframe)
RA_dframe$totalherbiv <- RA_dframe$chewing_tot+RA_dframe$stippling+RA_dframe$leafmines_tot+RA_dframe$leaf.galls+RA_dframe$sooty.mould+
RA_dframe$leafminer.oviholes+RA_dframe$leaf.roller
RA_dframe$binary_noherbiv <- ifelse(RA_dframe$totalherbiv>0, 1, 0)
View(RA_dframe)
RA_dframe$totalherbiv <- RA_dframe$chewing_tot+RA_dframe$stippling+RA_dframe$leafmines_tot+RA_dframe$sooty.mould+RA_dframe$leaf.galls
View(RA_dframe)
RA_dframe$totalherbiv <- RA_dframe$chewing_tot+RA_dframe$stippling+RA_dframe$leafmines_tot+RA_dframe$sooty.mould+RA_dframe$leaf.galls
RA_dframe$binary_noherbiv <- ifelse(RA_dframe$totalherbiv>0, 1, 0)
RA_dframe$binary_chew<- ifelse(RA_dframe$chewing_tot>0, 1, 0)
RA_dframe$binary_stipp <- ifelse(RA_dframe$stippling>0, 1, 0)
RA_dframe$binary_lmines <- ifelse(RA_dframe$leafmines_tot>0, 1, 0)
RA_dframe$binary_SM <- ifelse(RA_dframe$sooty.mould>0, 1, 0)
RA_dframe$binary_lgalls <- ifelse(RA_dframe$leaf.galls>0, 1, 0)
View(RA_dframe)
RA_dframe <- read.csv("rosid_asterid_data.csv")
names(RA_dframe)
attach(RA_dframe)
RA_dframe$leafmines_tot <- RA_dframe$serpentine.mine+RA_dframe$blotch.mine
RA_dframe$chewing_tot <- RA_dframe$ch_leafremoved+RA_dframe$skel
#melt into individual rows
RA_dframe_resh <- melt(RA_dframe, id.vars=c("plant_genus_species", "taxon", "MF", "abscission_num",
"herbarium", "date", "month", "day", "year", "doy",
"state", "phenology", "county"))
names(RA_dframe_resh)
names(RA_dframe)
RA_dframe_resh <- melt(RA_dframe, id.vars=c("plant_genus_species", "taxon", "MF", "abscission_num",
"herbarium", "date", "month", "month_cat", "day", "year", "doy",
"state", "phenology", "county"))
names(RA_dframe_resh)
RA_dframe_resh$binary <- ifelse(RA_dframe_resh$value>0, 1, 0)
topfive <- ddply(RA_dframe_resh, ~variable, summarize, mean_specdamaged = mean(binary, na.rm=T))
topfive <- topfive[order(-topfive$mean_specdamaged),]
#topfive = chewing_tot, stippling, sooty.mould, leafmines_tot, leaf.galls
topfive_RA_dframe_resh <- subset(RA_dframe_resh, variable=="chewing_tot"|variable=="stippling"|variable=="sooty.mould"|variable=="leafmines_tot"|
variable=="leaf.galls")
Fig1 <- ggplot(topfive_RA_dframe_resh, aes(value, colour=variable))
Fig1 <- Fig1 +  geom_freqpoly(binwidth = 1) +xlim(0,5) +theme_bw() +xlab("cells with herbivore damage") + ylab("specimens")
Fig1
RA_dframe$totalherbiv <- RA_dframe$chewing_tot+RA_dframe$stippling+RA_dframe$leafmines_tot+RA_dframe$sooty.mould+RA_dframe$leaf.galls
RA_dframe$binary_noherbiv <- ifelse(RA_dframe$totalherbiv>0, 1, 0)
RA_dframe$binary_chew<- ifelse(RA_dframe$chewing_tot>0, 1, 0)
RA_dframe$binary_stipp <- ifelse(RA_dframe$stippling>0, 1, 0)
RA_dframe$binary_lmines <- ifelse(RA_dframe$leafmines_tot>0, 1, 0)
RA_dframe$binary_SM <- ifelse(RA_dframe$sooty.mould>0, 1, 0)
RA_dframe$binary_lgalls <- ifelse(RA_dframe$leaf.galls>0, 1, 0)
Fig2_cont <- ggplot(topfive_RA_dframe_resh, aes(x=doy, y=value, colour=plant_genus_species))
Fig2_cont <- Fig2_cont +  geom_point() +ylim(0,5) +theme_bw() +xlab("day of year") + ylab("cells with herbivore damage")
Fig2_cont
topfive_RA_dframe_resh_gseason <- subset(topfive_RA_dframe_resh, month<10)
Fig2_cat <- ggplot(topfive_RA_dframe_resh, aes(x=month_cat, y=value, fill=plant_genus_species))
Fig2_cat <- Fig2_cat +  geom_bar(stat="identity") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
nrows(RA_dframe)
n.rows(RA_dframe)
dim(RA_dframe)
noherbiv_prop <- ddply(RA_dframe, c(variable,month_cat), summarize, noherbiv_prop = sum(binary_noherbiv, na.rm=T)/818)
noherbiv_prop <- ddply(RA_dframe, c(month_cat), summarize, noherbiv_prop = sum(binary_noherbiv, na.rm=T)/818)
View(noherbiv_prop)
View(RA_dframe)
noherbiv_prop <- ddply(RA_dframe, c(month_cat), summarize, noherbiv_prop = sum(binary_noherbiv, na.rm=T))
View(noherbiv_prop)
View(RA_dframe)
RA_dframe_resh2 <- melt(RA_dframe, id.vars=c("plant_genus_species", "taxon", "MF", "abscission_num",
"herbarium", "date", "month", "month_cat", "day", "year", "doy",
"state", "phenology", "county"))
names(RA_dframe_resh2)
RA_dframe_resh2_fig2 <- subset(RA_dframe_resh2, value== "binary_noherbiv"|value=="binary_chew"|value=="binary_stipp"|value=="binary_lmines"|
value=="binary_SM"|binary=="lgalls")
RA_dframe_resh2_fig2 <- subset(RA_dframe_resh2, value== "binary_noherbiv"|value=="binary_chew"|value=="binary_stipp"|value=="binary_lmines"|
value=="binary_SM"|binary=="binary_lgalls")
RA_dframe_resh2_fig2 <- subset(RA_dframe_resh2, variable== "binary_noherbiv"|variable=="binary_chew"|variable=="binary_stipp"|variable=="binary_lmines"|
variable=="binary_SM"|variable=="binary_lgalls")
View(RA_dframe_resh2_fig2)
topfive_RA_dframe_resh_gseason <- subset(topfive_RA_dframe_resh, month<10)
Fig2_cat <- ggplot(RA_dframe_resh_fig2, aes(x=month_cat, y=value, fill=variable))
Fig2_cat <- Fig2_cat +  geom_bar(stat="identity") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
topfive_RA_dframe_resh_gseason <- subset(topfive_RA_dframe_resh, month<10)
Fig2_cat <- ggplot(RA_dframe_resh2_fig2, aes(x=month_cat, y=value, fill=variable))
Fig2_cat <- Fig2_cat +  geom_bar(stat="identity") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
RA_dframe_resh2_fig2 <- subset(RA_dframe_resh2_fig2, month<10)
Fig2_cat <- ggplot(RA_dframe_resh2_fig2, aes(x=month_cat, y=value, fill=variable))
Fig2_cat <- Fig2_cat +  geom_bar(stat="identity") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
RA_dframe_resh2_fig2 <- subset(RA_dframe_resh2_fig2, month<10&&month>3)
Fig2_cat <- ggplot(RA_dframe_resh2_fig2, aes(x=month_cat, y=value, fill=variable))
Fig2_cat <- Fig2_cat +  geom_bar(stat="identity") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
RA_dframe_resh2_fig2 <- subset(RA_dframe_resh2_fig2, month<10 & month>3)
Fig2_cat <- ggplot(RA_dframe_resh2_fig2, aes(x=month_cat, y=value, fill=variable))
Fig2_cat <- Fig2_cat +  geom_bar(stat="identity") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
Fig2_cat <- ggplot(RA_dframe_resh2_fig2, aes(y=value, fill=variable))
Fig2_cat <- Fig2_cat +  geom_bar(stat="identity") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
Fig2_cat <- ggplot(RA_dframe_resh2_fig2, aes(x=month_cat, fill=variable))
Fig2_cat <- Fig2_cat +  geom_bar(stat="identity") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
Fig2_cat <- ggplot(RA_dframe_resh2_fig2, aes(x=month_cat, fill=variable))
Fig2_cat <- Fig2_cat +  geom_bar(position="fill") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
Fig2_cat <- ggplot(RA_dframe_resh, aes(x=month_cat, fill=variable))
Fig2_cat <- Fig2_cat +  geom_bar(position="fill") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
Fig2_cat <- ggplot(RA_dframe_resh, aes(x=month_cat, fill=variable)) + geom_bar(position="fill") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
RA_dframe_resh2_fig2 <- subset(RA_dframe_resh2_fig2, month<10 & month>3)
Fig2_cat <- ggplot(RA_dframe_resh, aes(x=values, fill=variable)) + geom_bar(position="fill") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
RA_dframe_resh2_fig2 <- subset(RA_dframe_resh2_fig2, month<10 & month>3)
Fig2_cat <- ggplot(RA_dframe_resh, aes(x=value, fill=variable)) + geom_bar(position="fill") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
props_summary <- ddply(RA_dframe_resh2_fig2, c(month_cat, variable), summarize, sum_wtype = sum(value, na.rm=T))
names(RA_dframe_resh2_fig2)
library(ggplot2)
library(reshape2)
library(plyr)
RA_dframe <- read.csv("rosid_asterid_data.csv")
names(RA_dframe)
attach(RA_dframe)
RA_dframe$leafmines_tot <- RA_dframe$serpentine.mine+RA_dframe$blotch.mine
RA_dframe$chewing_tot <- RA_dframe$ch_leafremoved+RA_dframe$skel
#melt into individual rows
RA_dframe_resh <- melt(RA_dframe, id.vars=c("plant_genus_species", "taxon", "MF", "abscission_num",
"herbarium", "date", "month", "month_cat", "day", "year", "doy",
"state", "phenology", "county"))
names(RA_dframe_resh)
#Making paper figures
#Figure 1: Zero inflation
#What are the most prevalent 5 types of herbivory?
RA_dframe_resh$binary <- ifelse(RA_dframe_resh$value>0, 1, 0)
topfive <- ddply(RA_dframe_resh, ~variable, summarize, mean_specdamaged = mean(binary, na.rm=T))
topfive <- topfive[order(-topfive$mean_specdamaged),]
#topfive = chewing_tot, stippling, sooty.mould, leafmines_tot, leaf.galls
topfive_RA_dframe_resh <- subset(RA_dframe_resh, variable=="chewing_tot"|variable=="stippling"|variable=="sooty.mould"|variable=="leafmines_tot"|
variable=="leaf.galls")
Fig1 <- ggplot(topfive_RA_dframe_resh, aes(value, colour=variable))
Fig1 <- Fig1 +  geom_freqpoly(binwidth = 1) +xlim(0,5) +theme_bw() +xlab("cells with herbivore damage") + ylab("specimens")
Fig1
#Figure 2: Progression of herbivory annually
#Continuous
Fig2_cont <- ggplot(topfive_RA_dframe_resh, aes(x=doy, y=value, colour=plant_genus_species))
Fig2_cont <- Fig2_cont +  geom_point() +ylim(0,5) +theme_bw() +xlab("day of year") + ylab("cells with herbivore damage")
Fig2_cont
#Cat
#Format data
RA_dframe$totalherbiv <- RA_dframe$chewing_tot+RA_dframe$stippling+RA_dframe$leafmines_tot+RA_dframe$sooty.mould+RA_dframe$leaf.galls
RA_dframe$binary_noherbiv <- ifelse(RA_dframe$totalherbiv>0, 1, 0)
RA_dframe$binary_chew<- ifelse(RA_dframe$chewing_tot>0, 1, 0)
RA_dframe$binary_stipp <- ifelse(RA_dframe$stippling>0, 1, 0)
RA_dframe$binary_lmines <- ifelse(RA_dframe$leafmines_tot>0, 1, 0)
RA_dframe$binary_SM <- ifelse(RA_dframe$sooty.mould>0, 1, 0)
RA_dframe$binary_lgalls <- ifelse(RA_dframe$leaf.galls>0, 1, 0)
RA_dframe_resh2 <- melt(RA_dframe, id.vars=c("plant_genus_species", "taxon", "MF", "abscission_num",
"herbarium", "date", "month", "month_cat", "day", "year", "doy",
"state", "phenology", "county"))
RA_dframe_resh2_fig2 <- subset(RA_dframe_resh2, variable== "binary_noherbiv"|variable=="binary_chew"|variable=="binary_stipp"|variable=="binary_lmines"|
variable=="binary_SM"|variable=="binary_lgalls")
props_summary <- ddply(RA_dframe_resh2_fig2, c(month_cat, variable), summarize, sum_wtype = sum(value, na.rm=T))
View(RA_dframe_resh2_fig2)
props_summary <- ddply(RA_dframe_resh2_fig2, c(.month_cat, .variable), summarize, sum_wtype = sum(value, na.rm=T))
props_summary <- ddply(RA_dframe_resh2_fig2, c(month_cat, .variable), summarize, sum_wtype = sum(value, na.rm=T))
props_summary <- ddply(RA_dframe_resh2_fig2, c("month_cat", "variable"), summarize, sum_wtype = sum(value, na.rm=T))
View(props_summary)
names(props_summary)
Fig2_cat <- ggplot(props_summary, aes(x=sum_wtype, fill=variable)) + geom_bar(position="fill") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
Fig2_cat <- ggplot(props_summary, aes(x=month, fill=variable)) + geom_bar(position="fill") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
Fig2_cat <- ggplot(props_summary, aes(x=month_cat, fill=variable)) + geom_bar(position="fill") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
names(props_summary)
Fig2_cat <- ggplot(props_summary, aes(x=month_cat, y=sum_wtype, fill=variable)) + geom_bar(position="fill") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
Fig2_cat <- ggplot(props_summary, aes(x=month_cat, y=sum_wtype, fill=variable)) + geom_bar(stat="identity") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
mar <- subset(RA_dframe_resh2_fig2 , month_cat=="mar")
levels(RA_dframe_resh2_fig2$month_cat
)
mar <- subset(RA_dframe_resh2_fig2, month_cat=="March")
mar <- subset(RA_dframe_resh2_fig2, month_cat=="March")
apr <- subset(RA_dframe_resh2_fig2, month_cat=="April")
may <- subset(RA_dframe_resh2_fig2, month_cat=="May")
jun <- subset(RA_dframe_resh2_fig2, month_cat=="June")
jul <- subset(RA_dframe_resh2_fig2, month_cat=="July")
aug <- subset(RA_dframe_resh2_fig2, month_cat=="August")
sept <- subset(RA_dframe_resh2_fig2, month_cat=="September")
oct <- subset(RA_dframe_resh2_fig2, month_cat=="October")
nrow(mar)
mar$prop <- value/nrow(mar)
mar$prop <- mar$value/nrow(mar)
View(mar)
prop(x) <-  { for (i in 1:length(x))
x$prop = x$value/nrow(x)
}
prop(x) <-  { for (i in 1:length(x)) {
x$prop = x$value/nrow(x)
}
}
prop <- function(x)  { for (i in 1:length(x)) {
x$prop = x$value/nrow(x)
}
}
prop(mar)
prop(jul)
View(jul)
View(mar)
mar$prop <- mar$value/nrow(mar)
apr$prop <- apr$value/nrow(apr)
may$prop <- may$value/nrow(may)
jun$prop <- mar$value/nrow(mar)
jul$prop <- mar$value/nrow(mar)
aug$prop <- mar$value/nrow(mar)
sept$prop <- mar$value/nrow(mar)
oct$prop <- mar$value/nrow(mar)
View(jul)
nrow(jul)
apr$prop <- apr$value/nrow(apr)
View(apr)
mar$prop <- mar$value/nrow(mar)
apr$prop <- apr$value/nrow(apr)
may$prop <- may$value/nrow(may)
jun$prop <- jun$value/nrow(jun)
jul$prop <- jul$value/nrow(jul)
aug$prop <- aug$value/nrow(aug)
sept$prop <- sept$value/nrow(sept)
oct$prop <- oct$value/nrow(oct)
View(apr)
names(mar)
props_summary <- rbind(mar, apr)
props_summary <- rbind(mar, apr, may, jun, jul, aug, sept, oct)
View(props_summary)
props_summary <- subset(props_summary, month<10 & month>3)
Fig2_cat <- ggplot(props_summary, aes(x=month_cat, y=prop, fill=variable)) + geom_bar(stat="identity") +theme_bw() + ylab("cells with herbivore damage")
Fig2_cat
View(mar)
View(may)
bplot <- ggplot(RA_dframe_resh, aes(x=variable, y=value, colour=variable))
bplot <- bplot + geom_boxplot() + geom_point() + theme(axis.text.x = element_text(angle=60, hjust=1)) +
ylab("cells with damage") + geom_jitter() + theme(legend.position="none")
bplot
bplot1a <- ggplot(RA_dframe_resh, aes(x=variable, y=value, colour=taxon))
bplot1a <- bplot1a + geom_boxplot() + geom_point() + theme(axis.text.x = element_text(angle=60, hjust=1)) +
ylab("cells with damage") + geom_jitter()
bplot1a
bplot1b <- ggplot(RA_dframe_resh, aes(x=variable, y=value, colour=state))
bplot1b <- bplot1b + geom_boxplot() + geom_point() + theme(axis.text.x = element_text(angle=60, hjust=1)) +
ylab("cells with damage") + geom_jitter()
bplot1b
#focus on chewing, because it's the most prevalent damage type
#cells with chewing damage by taxon & species
bplot2 <- ggplot(RA_dframe, aes(x=plant_genus_species, y=ch_leafremoved, colour=taxon))
bplot2 <- bplot2 + geom_boxplot() + geom_jitter() + theme(axis.text.x = element_text(angle=60, hjust=1)) + ylab("cells with chewing damage")
bplot2
bplot3 <- ggplot(RA_dframe, aes(x=year, y=ch_leafremoved))
bplot3 <- bplot3 + geom_point() + ylab("cells with chewing damage") + geom_jitter()
bplot3
bplot3 <- ggplot(RA_dframe, aes(x=taxon, y=ch_leafremoved, colour=taxon))
bplot3 <- bplot3 + geom_boxplot() + ylab("cells with chewing damage")
bplot3
bplot3 <- ggplot(RA_dframe, aes(x=state, y=ch_leafremoved, colour=state))
bplot3 <- bplot3 + geom_boxplot() + ylab("cells with chewing damage")
bplot3
facet1 <- ggplot(RA_dframe, aes(x=year, y=ch_leafremoved, colour=taxon)) + geom_point()
facet1 <- facet1 + facet_grid(state ~ ., margins=TRUE)
facet1
RA_dframe_rosids <- subset(RA_dframe, taxon == "rosid")
RA_dframe_asterids <- subset(RA_dframe, taxon == "asterid")
facet_a <- ggplot(RA_dframe_asterids, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
facet_a <- facet_a + facet_grid(plant_genus_species ~ ., margins=TRUE) + theme(legend.position= "none")
facet_a
#Continuous
Fig2_cont <- ggplot(topfive_RA_dframe_resh, aes(x=doy, y=value, colour=plant_genus_species))
Fig2_cont <- Fig2_cont +  geom_point() +ylim(0,5) +theme_bw() +xlab("day of year") + ylab("cells with herbivore damage")
Fig2_cont
levels(RA_dframe$plant_genus_species)
BATI <- subset(RA_dframe, plant_genus_species == "baptisia_tinctoria")
CLAL <- subset(RA_dframe, plant_genus_species == "clethra_alnifolia")
CORA <- subset(RA_dframe, plant_genus_species == "cornus_racemosa")
EPRE <- subset(RA_dframe, plant_genus_species == "epigaea_repens")
GATR <- subset(RA_dframe, plant_genus_species == "galium_triflorum")
GABA <- subset(RA_dframe, plant_genus_species == "gaylussacia_baccata")
KAAN <- subset(RA_dframe, plant_genus_species == "kalmia_angustifolia")
LEIN <- subset(RA_dframe, plant_genus_species == "lechea_intermedia")
LECA <- subset(RA_dframe, plant_genus_species == "lespedeza_capitata")
LEHI <- subset(RA_dframe, plant_genus_species == "lespedeza_hirta")
LUPA <- subset(RA_dframe, plant_genus_species == "ludwigia_palustris")
LYAM <- subset(RA_dframe, plant_genus_species == "lycopus_americanus")
LYTE <- subset(RA_dframe, plant_genus_species == "lysimachia_terrestris")
MEAR <- subset(RA_dframe, plant_genus_species == "mentha_arvensis")
POSA <- subset(RA_dframe, plant_genus_species == "polygala_sanguinea")
TRVI <- subset(RA_dframe, plant_genus_species == "triadenum_virginicum")
VAMA <- subset(RA_dframe, plant_genus_species == "vaccinium_macrocarpon")
VIBL <- subset(RA_dframe, plant_genus_species == "viola_blanda")
VICU <- subset(RA_dframe, plant_genus_species == "viola_cucullata")
VILA <- subset(RA_dframe, plant_genus_species == "vitis_labrusca")
bap <- ggplot(BATI, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
bap <- bap+ facet_grid(plant_genus_species ~ ., margins=TRUE) + theme(legend.position= "none")
bap
library(ggplot2)
bap <- ggplot(BATI, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
bap <- bap+ facet_grid(plant_genus_species ~ ., margins=TRUE) + theme(legend.position= "none")
bap
bap <- ggplot(BATI, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
bap <- bap+ theme(legend.position= "none")
bap
cle <- ggplot(CLAL, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
cle <- cle + theme(legend.position= "none")
cle
plo <- ggplot(BATI, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo <- plo + theme(legend.position= "none") + title("Baptisia tinctoria")
plo
plo <- ggplot(BATI, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo <- plo + theme(legend.position= "none") + ggtitle("Baptisia tinctoria")
plo
plo <- ggplot(CLAL, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo <- plo + theme(legend.position= "none") + + ggtitle("Clethra alnifolia")
plo
plo <- ggplot(BATI, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(CLAL, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(CORA, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(EPRE, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(GATR, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(GABA, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(KAAN, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(LEIN, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(LECA, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(LEHI, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(LUPA, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(LYAM, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(LYTE, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(MEAR, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(POSA, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(TRVI, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(VAMA, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(VIBL, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo <- plo + theme(legend.position= "none")
plo
plo <- ggplot(VIBL, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(VICU, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(VILA, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
library(ggplot2)
library(reshape2)
library(plyr)
RA_dframe <- read.csv("rosid_asterid_data.csv")
names(RA_dframe)
attach(RA_dframe)
RA_dframe$leafmines_tot <- RA_dframe$serpentine.mine+RA_dframe$blotch.mine
RA_dframe$chewing_tot <- RA_dframe$ch_leafremoved+RA_dframe$skel
#melt into individual rows
RA_dframe_resh <- melt(RA_dframe, id.vars=c("plant_genus_species", "taxon", "MF", "abscission_num",
"herbarium", "date", "month", "month_cat", "day", "year", "doy",
"state", "phenology", "county"))
names(RA_dframe_resh)
#What are the most prevalent 5 types of herbivory?
RA_dframe_resh$binary <- ifelse(RA_dframe_resh$value>0, 1, 0)
topfive <- ddply(RA_dframe_resh, ~variable, summarize, mean_specdamaged = mean(binary, na.rm=T))
topfive <- topfive[order(-topfive$mean_specdamaged),]
#topfive = chewing_tot, stippling, sooty.mould, leafmines_tot, leaf.galls
topfive_RA_dframe_resh <- subset(RA_dframe_resh, variable=="chewing_tot"|variable=="stippling"|variable=="sooty.mould"|variable=="leafmines_tot"|
variable=="leaf.galls")
#Format data
RA_dframe$totalherbiv <- RA_dframe$chewing_tot+RA_dframe$stippling+RA_dframe$leafmines_tot+RA_dframe$sooty.mould+RA_dframe$leaf.galls
RA_dframe$binary_noherbiv <- ifelse(RA_dframe$totalherbiv>0, 1, 0)
RA_dframe$binary_chew<- ifelse(RA_dframe$chewing_tot>0, 1, 0)
RA_dframe$binary_stipp <- ifelse(RA_dframe$stippling>0, 1, 0)
RA_dframe$binary_lmines <- ifelse(RA_dframe$leafmines_tot>0, 1, 0)
RA_dframe$binary_SM <- ifelse(RA_dframe$sooty.mould>0, 1, 0)
RA_dframe$binary_lgalls <- ifelse(RA_dframe$leaf.galls>0, 1, 0)
RA_dframe_resh2 <- melt(RA_dframe, id.vars=c("plant_genus_species", "taxon", "MF", "abscission_num",
"herbarium", "date", "month", "month_cat", "day", "year", "doy",
"state", "phenology", "county"))
RA_dframe_resh2_fig2 <- subset(RA_dframe_resh2, variable== "binary_noherbiv"|variable=="binary_chew"|variable=="binary_stipp"|variable=="binary_lmines"|
variable=="binary_SM"|variable=="binary_lgalls")
mar <- subset(RA_dframe_resh2_fig2, month_cat=="March")
apr <- subset(RA_dframe_resh2_fig2, month_cat=="April")
may <- subset(RA_dframe_resh2_fig2, month_cat=="May")
jun <- subset(RA_dframe_resh2_fig2, month_cat=="June")
jul <- subset(RA_dframe_resh2_fig2, month_cat=="July")
aug <- subset(RA_dframe_resh2_fig2, month_cat=="August")
sept <- subset(RA_dframe_resh2_fig2, month_cat=="September")
oct <- subset(RA_dframe_resh2_fig2, month_cat=="October")
names(RA_dframe)
model <- lme(ch_leafremoved~doy+year+state, random = ~1|plant_genus_species, na.action=na.omit, data=RA_dframe)
summary(model)
library(nlme)
model <- lme(ch_leafremoved~doy+year+state, random = ~1|plant_genus_species, na.action=na.omit, data=RA_dframe)
summary(model)
model <- lme(ch_leafremoved~doy*year+state, random = ~1|plant_genus_species, na.action=na.omit, data=RA_dframe)
summary(model)
model <- lme(ch_leafremoved~doy+year+state, random = ~1|plant_genus_species, na.action=na.omit, data=RA_dframe)
summary(model)
RA_dframe_resh$binary <- ifelse(RA_dframe_resh$value>0, 1, 0)
topfive <- ddply(RA_dframe_resh, ~variable, summarize, mean_specdamaged = mean(binary, na.rm=T))
topfive <- topfive[order(-topfive$mean_specdamaged),]
#topfive = chewing_tot, stippling, sooty.mould, leafmines_tot, leaf.galls
topfive_RA_dframe_resh <- subset(RA_dframe_resh, variable=="chewing_tot"|variable=="stippling"|variable=="sooty.mould"|variable=="leafmines_tot"|
variable=="leaf.galls")
Fig1 <- ggplot(topfive_RA_dframe_resh, aes(value, colour=variable))
Fig1 <- Fig1 +  geom_freqpoly(binwidth = 1) +xlim(0,5) +theme_bw() +xlab("cells with herbivore damage") + ylab("specimens")
Fig1
plo <- ggplot(BATI, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(CLAL, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(CORA, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(EPRE, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
plo <- ggplot(GATR, aes(x=doy, y=ch_leafremoved, colour=plant_genus_species)) + geom_point() + geom_abline()
plo
model <- lme(ch_leafremoved~doy+year+state, random = ~1|plant_genus_species, na.action=na.omit, data=RA_dframe)
summary(model)
