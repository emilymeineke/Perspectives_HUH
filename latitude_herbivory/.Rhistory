nAGQ = 10)
summary(model)
library(lme4)
library(nlme)
model <- glmer(chew_prop~decimalLatitude+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAchew, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
merged_noNAskel <- subset(merged, skel != "NA")
merged_noNAskel$totalboxes <- 5
merged_noNAskel$skel_prop <- merged_noNAskel$skel/merged_noNAskel$totalboxes
model <- glmer(skel_prop~decimalLatitude+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAskel, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
merged_noNAstippling <- subset(merged, stippling != "NA")
merged_noNAstippling$totalboxes <- 5
merged_noNAstippling$stippling_prop <- merged_noNAstippling$stippling/merged_noNAstippling$totalboxes
model <- glmer(stippling_prop~decimalLatitude+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAstippling, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
merged_noNAsooty.mould <- subset(merged, sooty.mould != "NA")
merged_noNAsooty.mould$totalboxes <- 5
merged_noNAsooty.mould$sooty.mould_prop <- merged_noNAsooty.mould$sooty.mould/merged_noNAsooty.mould$totalboxes
model <- glmer(sooty.mould_prop~decimalLatitude+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAsooty.mould, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
model <- glmer(blotch.mine_prop~decimalLatitude+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAblotch.mine, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
merged_noNAblotch.mine <- subset(merged, blotch.mine != "NA")
merged_noNAblotch.mine$totalboxes <- 5
merged_noNAblotch.mine$blotch.mine_prop <- merged_noNAblotch.mine$blotch.mine/merged_noNAblotch.mine$totalboxes
model <- glmer(blotch.mine_prop~decimalLatitude+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAblotch.mine, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
names(merged)
ggplot(merged, aes(x=decimalLatitude, y=serpentine.mine, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=decimalLatitude, y=serpentine.mine)) + geom_point()
ggplot(VACO, aes(x=decimalLatitude, y=serpentine.mine)) + geom_point()
ggplot(QUBI, aes(x=decimalLatitude, y=serpentine.mine)) + geom_point()
ggplot(CAOV, aes(x=decimalLatitude, y=serpentine.mine)) + geom_point()
merged_noNAserpentine.mine <- subset(merged, serpentine.mine != "NA")
merged_noNAserpentine.mine$totalboxes <- 5
merged_noNAserpentine.mine$serpentine.mine_prop <- merged_noNAserpentine.mine$serpentine.mine/merged_noNAserpentine.mine$totalboxes
model <- glmer(serpentine.mine_prop~decimalLatitude+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAserpentine.mine, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
merged_noNAblotch.mine <- subset(merged, blotch.mine != "NA")
merged_noNAblotch.mine$totalboxes <- 5
merged_noNAblotch.mine$blotch.mine_prop <- merged_noNAblotch.mine$blotch.mine/merged_noNAblotch.mine$totalboxes
model <- glmer(blotch.mine_prop~decimalLatitude+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAblotch.mine, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
ggplot(merged, aes(x=decimalLatitude, y=leafremoved, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(VACO, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(QUBI, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(CAOV, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(DECA, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(VACO, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(QUBI, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(CAOV, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=skel, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=decimalLatitude, y=skel)) + geom_point()
ggplot(VACO, aes(x=decimalLatitude, y=skel)) + geom_point()
ggplot(QUBI, aes(x=decimalLatitude, y=skel)) + geom_point()
ggplot(CAOV, aes(x=decimalLatitude, y=skel)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=stippling, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=decimalLatitude, y=stippling)) + geom_point()
ggplot(VACO, aes(x=decimalLatitude, y=stippling)) + geom_point()
ggplot(QUBI, aes(x=decimalLatitude, y=stippling)) + geom_point()
ggplot(CAOV, aes(x=decimalLatitude, y=stippling)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=serpentine.mine, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=decimalLatitude, y=serpentine.mine)) + geom_point()
ggplot(VACO, aes(x=decimalLatitude, y=serpentine.mine)) + geom_point()
ggplot(QUBI, aes(x=decimalLatitude, y=serpentine.mine)) + geom_point()
ggplot(CAOV, aes(x=decimalLatitude, y=serpentine.mine)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=blotch.mine, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=decimalLatitude, y=blotch.mine)) + geom_point()
ggplot(VACO, aes(x=decimalLatitude, y=blotch.mine)) + geom_point()
write.table(merged, file="output_countycentroids_herbivory.csv")
write.csv(merged, file="output_countycentroids_herbivory.csv")
names(merged)
average_chew <- ddply(merged, c(county,decimalLatitude), summarize, mean_lrem = mean(leafremoved, na.rm=T))
library(plyr)
average_chew <- ddply(merged, c("county","decimalLatitude"), summarize, mean_lrem = mean(leafremoved, na.rm=T))
View(average_chew)
average_chew <- ddply(merged, c("county","decimalLatitude"), summarize, mean_lrem = mean(leafremoved, na.rm=T))
average_skel <- ddply(merged, c("county","decimalLatitude"), summarize, mean_skel = mean(skel, na.rm=T))
average_stipp <- ddply(merged, c("county","decimalLatitude"), summarize, mean_stipp = mean(stippling, na.rm=T))
average_bmines <- ddply(merged, c("county","decimalLatitude"), summarize, mean_bmine = mean(blotch.mine, na.rm=T))
average_serpmines <- ddply(merged, c("county","decimalLatitude"), summarize, mean_smine = mean(serpentine.mine, na.rm=T))
average_SM <- ddply(merged, c("county","decimalLatitude"), summarize, mean_SM = mean(sooty.mould, na.rm=T))
merge_averages <- merge(average_chew, average_skel, average_stipp, average_bmines, by="county")
df <- join_all(list(average_chew, average_skel, average_stipp), by = 'county', type = 'full')
View(df)
merge_averages <- merge(average_chew, average_skel, average_stipp, average_bmines, by="county")
df <- join_all(list(average_chew, average_skel, average_stipp, average_bmines,
average_serpmines, average_SM), by = 'county', type = 'full')
View(df)
average_chew <- ddply(merged, c("county","decimalLatitude"), summarize, mean_lrem = mean(leafremoved, na.rm=T))
average_skel <- ddply(merged, c("county","decimalLatitude"), summarize, mean_skel = mean(skel, na.rm=T))
average_stipp <- ddply(merged, c("county","decimalLatitude"), summarize, mean_stipp = mean(stippling, na.rm=T))
average_bmines <- ddply(merged, c("county","decimalLatitude"), summarize, mean_bmine = mean(blotch.mine, na.rm=T))
average_serpmines <- ddply(merged, c("county","decimalLatitude"), summarize, mean_smine = mean(serpentine.mine, na.rm=T))
average_SM <- ddply(merged, c("county","decimalLatitude"), summarize, mean_SM = mean(sooty.mould, na.rm=T))
df <- join_all(list(average_chew, average_skel, average_stipp, average_bmines,
average_serpmines, average_SM), by = 'county', type = 'full')
#Next step --> Download merged data and lo
View(average_bmines)
df <- join_all(list(average_chew, average_skel, average_stipp, average_bmines,
average_serpmines, average_SM), by = 'county', type = 'full')
View(df)
View(average_chew)
df <- join_all(list(average_chew, average_skel, average_stipp, average_bmines,
average_serpmines, average_SM), by = row.names, type = 'full')
df <- join_all(list(average_chew, average_skel, average_stipp, average_bmines,
average_serpmines, average_SM), by = rownames, type = 'full')
average_chew <- ddply(merged, c("county","decimalLatitude", "state"), summarize, mean_lrem = mean(leafremoved, na.rm=T))
average_skel <- ddply(merged, c("county","decimalLatitude", "state"), summarize, mean_skel = mean(skel, na.rm=T))
average_stipp <- ddply(merged, c("county","decimalLatitude", "state"), summarize, mean_stipp = mean(stippling, na.rm=T))
average_bmines <- ddply(merged, c("county","decimalLatitude", "state"), summarize, mean_bmine = mean(blotch.mine, na.rm=T))
average_serpmines <- ddply(merged, c("county","decimalLatitude", "state"), summarize, mean_smine = mean(serpentine.mine, na.rm=T))
average_SM <- ddply(merged, c("county","decimalLatitude", "state"), summarize, mean_SM = mean(sooty.mould, na.rm=T))
df <- join_all(list(average_chew, average_skel, average_stipp, average_bmines,
average_serpmines, average_SM), by = c("county","state"), type = 'full')
#Next step --> Down
View(df)
write.csv(df, file="output_countycentroids_herbivory_average.csv")
average_chew <- ddply(merged, c("county","decimalLatitude", "decimalLongitude", "state"), summarize, mean_lrem = mean(leafremoved, na.rm=T))
average_chew
average_chew <- ddply(merged, c("county","decimalLatitude", "decimalLongitude", "state"), summarize, mean_lrem = mean(leafremoved, na.rm=T))
average_skel <- ddply(merged, c("county","decimalLatitude", "decimalLongitude", "state"), summarize, mean_skel = mean(skel, na.rm=T))
average_stipp <- ddply(merged, c("county","decimalLatitude", "decimalLongitude",  "state"), summarize, mean_stipp = mean(stippling, na.rm=T))
average_bmines <- ddply(merged, c("county","decimalLatitude", "decimalLongitude", "state"), summarize, mean_bmine = mean(blotch.mine, na.rm=T))
average_serpmines <- ddply(merged, c("county","decimalLatitude","decimalLongitude", "state"), summarize, mean_smine = mean(serpentine.mine, na.rm=T))
average_SM <- ddply(merged, c("county","decimalLatitude", "decimalLongitude", "state"), summarize, mean_SM = mean(sooty.mould, na.rm=T))
df <- join_all(list(average_chew, average_skel, average_stipp, average_bmines,
average_serpmines, average_SM), by = c("county","state"), type = 'full')
#Next step --> Download merged data and load into qgis to make maps
write.csv(merged, file="output_countycentroids_herbivory.csv")
write.csv(df, file="output_countycentroids_herbivory_average.csv")
names(merged)
merged_noNAchew <- subset(merged, leafremoved != "NA")
merged_noNAchew$totalboxes <- 5
merged_noNAchew$chew_prop <- merged_noNAchew$leafremoved/merged_noNAchew$totalboxes
model <- glmer(chew_prop~decimalLatitude+year+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAchew, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
#Same model with skeletonization
merged_noNAskel <- subset(merged, skel != "NA")
merged_noNAskel$totalboxes <- 5
merged_noNAskel$skel_prop <- merged_noNAskel$skel/merged_noNAskel$totalboxes
model <- glmer(skel_prop~decimalLatitude+year+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAskel, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
#Same model with stippling
merged_noNAstippling <- subset(merged, stippling != "NA")
merged_noNAstippling$totalboxes <- 5
merged_noNAstippling$stippling_prop <- merged_noNAstippling$stippling/merged_noNAstippling$totalboxes
model <- glmer(stippling_prop~decimalLatitude+year+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAstippling, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
merged_noNAsooty.mould <- subset(merged, sooty.mould != "NA")
merged_noNAsooty.mould$totalboxes <- 5
merged_noNAsooty.mould$sooty.mould_prop <- merged_noNAsooty.mould$sooty.mould/merged_noNAsooty.mould$totalboxes
model <- glmer(sooty.mould_prop~decimalLatitude+year+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAsooty.mould, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
merged_noNAblotch.mine <- subset(merged, blotch.mine != "NA")
merged_noNAblotch.mine$totalboxes <- 5
merged_noNAblotch.mine$blotch.mine_prop <- merged_noNAblotch.mine$blotch.mine/merged_noNAblotch.mine$totalboxes
model <- glmer(blotch.mine_prop~decimalLatitude+year+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAblotch.mine, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
merged_noNAserpentine.mine <- subset(merged, serpentine.mine != "NA")
merged_noNAserpentine.mine$totalboxes <- 5
merged_noNAserpentine.mine$serpentine.mine_prop <- merged_noNAserpentine.mine$serpentine.mine/merged_noNAserpentine.mine$totalboxes
model <- glmer(serpentine.mine_prop~decimalLatitude+year+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAserpentine.mine, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
plot(merged$year, merged$leafremoved)
plot(DECA$year, DECA$leafremoved)
plot(VACO$year, VACO$leafremoved)
plot(QUBI$year, QUBI$leafremoved)
ggplot(merged, aes(x=decimalLatitude, y=leafremoved, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(VACO, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(QUBI, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(CAOV, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=skel, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=decimalLatitude, y=skel)) + geom_point()
ggplot(VACO, aes(x=decimalLatitude, y=skel)) + geom_point()
ggplot(QUBI, aes(x=decimalLatitude, y=skel)) + geom_point()
ggplot(CAOV, aes(x=decimalLatitude, y=skel)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=stippling, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=decimalLatitude, y=stippling)) + geom_point()
ggplot(VACO, aes(x=decimalLatitude, y=stippling)) + geom_point()
ggplot(QUBI, aes(x=decimalLatitude, y=stippling)) + geom_point()
ggplot(CAOV, aes(x=decimalLatitude, y=stippling)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=serpentine.mine, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=decimalLatitude, y=serpentine.mine)) + geom_point()
ggplot(VACO, aes(x=decimalLatitude, y=serpentine.mine)) + geom_point()
ggplot(QUBI, aes(x=decimalLatitude, y=serpentine.mine)) + geom_point()
ggplot(CAOV, aes(x=decimalLatitude, y=serpentine.mine)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=blotch.mine, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=decimalLatitude, y=blotch.mine)) + geom_point()
ggplot(VACO, aes(x=decimalLatitude, y=blotch.mine)) + geom_point()
ggplot(QUBI, aes(x=decimalLatitude, y=blotch.mine)) + geom_point()
ggplot(CAOV, aes(x=decimalLatitude, y=blotch.mine)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=sooty.mould, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=decimalLatitude, y=sooty.mould)) + geom_point()
ggplot(VACO, aes(x=decimalLatitude, y=sooty.mould)) + geom_point()
ggplot(QUBI, aes(x=decimalLatitude, y=sooty.mould)) + geom_point()
ggplot(CAOV, aes(x=decimalLatitude, y=sooty.mould)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=unknown.lesions, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=decimalLatitude, y=unknown.lesions)) + geom_point()
ggplot(VACO, aes(x=decimalLatitude, y=unknown.lesions)) + geom_point()
ggplot(QUBI, aes(x=decimalLatitude, y=unknown.lesions)) + geom_point()
ggplot(CAOV, aes(x=decimalLatitude, y=unknown.lesions)) + geom_point()
plot(average_chew$decimalLatitude, average_chew$mean_lrem)
average_chew <- ddply(merged, c("county","decimalLatitude", "decimalLongitude", "state", "plant_genus_species"), summarize, mean_lrem = mean(leafremoved, na.rm=T))
average_skel <- ddply(merged, c("county","decimalLatitude", "decimalLongitude", "state", "plant_genus_species"), summarize, mean_skel = mean(skel, na.rm=T))
average_stipp <- ddply(merged, c("county","decimalLatitude", "decimalLongitude",  "state", "plant_genus_species"), summarize, mean_stipp = mean(stippling, na.rm=T))
average_bmines <- ddply(merged, c("county","decimalLatitude", "decimalLongitude", "state", "plant_genus_species"), summarize, mean_bmine = mean(blotch.mine, na.rm=T))
average_serpmines <- ddply(merged, c("county","decimalLatitude","decimalLongitude", "state", "plant_genus_species"), summarize, mean_smine = mean(serpentine.mine, na.rm=T))
average_SM <- ddply(merged, c("county","decimalLatitude", "decimalLongitude", "state", "plant_genus_species"), summarize, mean_SM = mean(sooty.mould, na.rm=T))
average_chew <- ddply(merged, c("county","decimalLatitude", "decimalLongitude", "state", "plant_genus_species"), summarize, mean_lrem = mean(leafremoved, na.rm=T))
average_skel <- ddply(merged, c("county","decimalLatitude", "decimalLongitude", "state", "plant_genus_species"), summarize, mean_skel = mean(skel, na.rm=T))
average_stipp <- ddply(merged, c("county","decimalLatitude", "decimalLongitude",  "state", "plant_genus_species"), summarize, mean_stipp = mean(stippling, na.rm=T))
average_bmines <- ddply(merged, c("county","decimalLatitude", "decimalLongitude", "state", "plant_genus_species"), summarize, mean_bmine = mean(blotch.mine, na.rm=T))
average_serpmines <- ddply(merged, c("county","decimalLatitude","decimalLongitude", "state", "plant_genus_species"), summarize, mean_smine = mean(serpentine.mine, na.rm=T))
average_SM <- ddply(merged, c("county","decimalLatitude", "decimalLongitude", "state", "plant_genus_species"), summarize, mean_SM = mean(sooty.mould, na.rm=T))
df <- join_all(list(average_chew, average_skel, average_stipp, average_bmines,
average_serpmines, average_SM), by = c("county","state"), type = 'full')
View(df)
View(average_chew)
average_chew_species <- ddply(merged, c("county","decimalLatitude", "decimalLongitude", "state", "plant_genus_species"), summarize, mean_lrem = mean(leafremoved, na.rm=T))
average_chew_DECA <- subset(average_chew_species, plant_genus_species == "desmodium_canadense")
average_chew_VAAN <-  subset(average_chew_species, plant_genus_species == "vaccinium_angustifolium")
average_chew_QUBI <-  subset(average_chew_species, plant_genus_species == "quercus_bicolor")
average_chew_CAOV <-  subset(average_chew_species, plant_genus_species == "carya_ovata")
View(average_chew_CAOV)
plot(average_chew_DECA $decimalLatitude, average_chew_DECA$mean_lrem)
plot(average_chew_VAAN$decimalLatitude, average_chew_VAAN$mean_lrem)
plot(average_chew_QUBI$decimalLatitude, average_chew_QUBI$mean_lrem)
plot(average_chew_CAOV$decimalLatitude, average_chew_CAOV$mean_lrem)
plot(average_chew_DECA$decimalLatitude, average_chew_DECA$mean_lrem)
plot(average_chew_VAAN$decimalLatitude, average_chew_VAAN$mean_lrem)
plot(average_chew_QUBI$decimalLatitude, average_chew_QUBI$mean_lrem)
plot(average_chew_CAOV$decimalLatitude, average_chew_CAOV$mean_lrem)
df <- join_all(list(average_chew, average_skel, average_stipp, average_bmines,
average_serpmines, average_SM), by = c("county","state"), type = 'full')
ggplot(merged, aes(x=year, y=leafremoved, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=year, y=leafremoved)) + geom_point()
ggplot(VAAN, aes(x=year, y=leafremoved)) + geom_point()
DECA <- subset(merged, plant_genus_species =="desmodium_canadense")
VAAN <- subset(merged, plant_genus_species =="vaccinium_angustifolium")
QUBI <- subset(merged, plant_genus_species =="quercus_bicolor")
CAOV <- subset(merged, plant_genus_species =="carya_ovata")
ggplot(merged, aes(x=year, y=leafremoved, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=year, y=leafremoved)) + geom_point()
ggplot(VAAN, aes(x=year, y=leafremoved)) + geom_point()
ggplot(QUBI, aes(x=year, y=leafremoved)) + geom_point()
ggplot(CAOV, aes(x=year, y=leafremoved)) + geom_point()
ggplot(merged, aes(x=year, y=skel, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=year, y=skel)) + geom_point()
ggplot(VAAN, aes(x=year, y=skel)) + geom_point()
ggplot(QUBI, aes(x=year, y=skel)) + geom_point()
ggplot(CAOV, aes(x=year, y=skel)) + geom_point()
ggplot(merged, aes(x=year, y=stippling, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=year, y=stippling)) + geom_point()
ggplot(VAAN, aes(x=year, y=stippling)) + geom_point()
ggplot(QUBI, aes(x=year, y=stippling)) + geom_point()
ggplot(CAOV, aes(x=year, y=stippling)) + geom_point()
ggplot(merged, aes(x=year, y=serpentine.mine, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=year, y=serpentine.mine)) + geom_point()
ggplot(VAAN, aes(x=year, y=serpentine.mine)) + geom_point()
ggplot(QUBI, aes(x=year, y=serpentine.mine)) + geom_point()
ggplot(CAOV, aes(x=year, y=serpentine.mine)) + geom_point()
ggplot(merged, aes(x=year, y=blotch.mine, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=year, y=blotch.mine)) + geom_point()
ggplot(VAAN, aes(x=year, y=blotch.mine)) + geom_point()
ggplot(QUBI, aes(x=year, y=blotch.mine)) + geom_point()
ggplot(CAOV, aes(x=year, y=blotch.mine)) + geom_point()
ggplot(merged, aes(x=year, y=sooty.mould, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=year, y=sooty.mould)) + geom_point()
ggplot(VAAN, aes(x=year, y=sooty.mould)) + geom_point()
ggplot(QUBI, aes(x=year, y=sooty.mould)) + geom_point()
ggplot(CAOV, aes(x=year, y=sooty.mould)) + geom_point()
ggplot(merged, aes(x=year, y=unknown.lesions, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=year, y=unknown.lesions)) + geom_point()
ggplot(VAAN, aes(x=year, y=unknown.lesions)) + geom_point()
ggplot(QUBI, aes(x=year, y=unknown.lesions)) + geom_point()
ggplot(CAOV, aes(x=year, y=unknown.lesions)) + geom_point()
model <- glmer(chew_prop~decimalLatitude+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAchew, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
plot(average_chew_DECA$decimalLatitude, average_chew_DECA$mean_lrem)
plot(average_chew_VAAN$decimalLatitude, average_chew_VAAN$mean_lrem)
plot(average_chew_QUBI$decimalLatitude, average_chew_QUBI$mean_lrem)
plot(average_chew_CAOV$decimalLatitude, average_chew_CAOV$mean_lrem)
names(merged)
model <- glmer(chew_prop~decimalLatitude+doy+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAchew, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
names(merged)
merged$date <- as.Date(merged$date)
model <- glmer(chew_prop~decimalLatitude+month+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAchew, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
names(merged)
model <- glmer(skel_prop~decimalLatitude+month+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAskel, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
model <- glmer(stippling_prop~decimalLatitude+month+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAstippling, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
model <- glmer(sooty.mould_prop~decimalLatitude+month+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAsooty.mould, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
model <- glmer(blotch.mine_prop~decimalLatitude+month+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAblotch.mine, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
model <- glmer(serpentine.mine_prop~decimalLatitude+month+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAserpentine.mine, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
model <- glmer(sooty.mould_prop~decimalLatitude+month+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAsooty.mould, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
average_chew_species <- ddply(merged, c("county","decimalLatitude", "decimalLongitude", "state", "plant_genus_species"), summarize, mean_lrem = mean(leafremoved, na.rm=T))
average_skel_species <- ddply(merged, c("county","decimalLatitude", "decimalLongitude", "state", "plant_genus_species"), summarize, mean_skel = mean(skel, na.rm=T))
average_stipp_species <- ddply(merged, c("county","decimalLatitude", "decimalLongitude",  "state", "plant_genus_species"), summarize, mean_stipp = mean(stippling, na.rm=T))
average_bmines_species <- ddply(merged, c("county","decimalLatitude", "decimalLongitude", "state", "plant_genus_species"), summarize, mean_bmine = mean(blotch.mine, na.rm=T))
average_serpmines_species <- ddply(merged, c("county","decimalLatitude","decimalLongitude", "state", "plant_genus_species"), summarize, mean_smine = mean(serpentine.mine, na.rm=T))
average_SM_species <- ddply(merged, c("county","decimalLatitude", "decimalLongitude", "state", "plant_genus_species"), summarize, mean_SM = mean(sooty.mould, na.rm=T))
average_chew_DECA <- subset(average_chew_species, plant_genus_species == "desmodium_canadense")
average_skel_DECA <- subset(average_skel_species, plant_genus_species == "desmodium_canadense")
average_stipp_DECA <- subset(average_stipp_species, plant_genus_species == "desmodium_canadense")
average_bmines_DECA <- subset(average_bmines_species, plant_genus_species == "desmodium_canadense")
average_serpmines_DECA <- subset(average_serpmines_species, plant_genus_species == "desmodium_canadense")
average_SM_DECA <- subset(average_SM_species, plant_genus_species == "desmodium_canadense")
View(average_serpmines_DECA)
df_DECA <- join_all(list(average_chew_DECA, average_skel_DECA, average_stipp_DECA, average_bmines_DECA,
average_serpmines_DECA, average_SM_DECA), by = c("county","state"), type = 'full')
View(df_DECA)
average_chew_VAAN <- subset(average_chew_species, plant_genus_species == "vaccinium_angustifolium")
average_skel_VAAN <- subset(average_skel_species, plant_genus_species == "vaccinium_angustifolium")
average_stipp_VAAN <- subset(average_stipp_species, plant_genus_species == "vaccinium_angustifolium")
average_bmines_VAAN <- subset(average_bmines_species, plant_genus_species == "vaccinium_angustifolium")
average_serpmines_VAAN <- subset(average_serpmines_species, plant_genus_species == "vaccinium_angustifolium")
average_SM_VAAN <- subset(average_SM_species, plant_genus_species == "vaccinium_angustifolium")
df_VAAN <- join_all(list(average_chew_VAAN, average_skel_VAAN, average_stipp_VAAN, average_bmines_VAAN,
average_serpmines_VAAN, average_SM_VAAN), by = c("county","state"), type = 'full')
View(df_VAAN)
average_chew_QUBI <- subset(average_chew_species, plant_genus_species == "quercus_bicolor")
average_skel_QUBI <- subset(average_skel_species, plant_genus_species == "quercus_bicolor")
average_stipp_QUBI <- subset(average_stipp_species, plant_genus_species == "quercus_bicolor")
average_bmines_QUBI <- subset(average_bmines_species, plant_genus_species == "quercus_bicolor")
average_serpmines_QUBI <- subset(average_serpmines_species, plant_genus_species == "quercus_bicolor")
average_SM_QUBI <- subset(average_SM_species, plant_genus_species == "quercus_bicolor")
df_QUBI <- join_all(list(average_chew_QUBI, average_skel_QUBI, average_stipp_QUBI, average_bmines_QUBI,
average_serpmines_QUBI, average_SM_QUBI), by = c("county","state"), type = 'full')
average_chew_CAOV <- subset(average_chew_species, plant_genus_species == "carya_ovata")
average_skel_CAOV <- subset(average_skel_species, plant_genus_species == "carya_ovata")
average_stipp_CAOV <- subset(average_stipp_species, plant_genus_species == "carya_ovata")
average_bmines_CAOV <- subset(average_bmines_species, plant_genus_species == "carya_ovata")
average_serpmines_CAOV <- subset(average_serpmines_species, plant_genus_species == "carya_ovata")
average_SM_CAOV <- subset(average_SM_species, plant_genus_species == "carya_ovata")
df_CAOV <- join_all(list(average_chew_CAOV, average_skel_CAOV, average_stipp_CAOV, average_bmines_CAOV,
average_serpmines_CAOV, average_SM_CAOV), by = c("county","state"), type = 'full')
View(df_CAOV)
write.csv(df_DECA, file="output_herbiv_avgs_DECA.csv")
write.csv(df_VAAN, file="output_herbiv_avgs_VAAN.csv")
write.csv(df_QUBI, file="output_herbiv_avgs_QUBI.csv")
write.csv(df_CAOV, file="output_herbiv_avgs_CAOV.csv")
df_QUBI
df_QUBI <- subset(dfQUBI, mean_lrem !="NaN")
df_QUBI <- subset(df_QUBI, mean_lrem !="NaN")
View(df_QUBI)
write.csv(df_QUBI, file="output_herbiv_avgs_QUBI.csv")
chew_glm <- glm(chew_prop~decimalLatitude*plant_genus_species, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAchew)
summary(chew_glm)
chew_glm <- glm(chew_prop~decimalLatitude*plant_genus_species+month, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAchew)
summary(chew_glm)
skel_glm <- glm(skel_prop~decimalLatitude*plant_genus_species+month, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAskel)
summary(skel_glm)
stipp_glm <- glm(stippling_prop~decimalLatitude*plant_genus_species+month, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAstippling)
summary(stipp_glm)
model <- glmer(stippling_prop~decimalLatitude+month+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAstippling, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
SMine_glm <- glm(serpentine.mine_prop~decimalLatitude*plant_genus_species+month, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAserpentine.mine)
summary(SMine_glm)
BM_glm <- glm(blotch.mine_prop~decimalLatitude*plant_genus_species+month, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAblotch.mine)
summary(BM_glm)
SM_glm <- glm(sooty.mould_prop~decimalLatitude*plant_genus_species+month, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAsooty.mould)
summary(SM_glm)
SM_glm <- glm(sooty.mould_prop~decimalLatitude+plant_genus_species+month, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAsooty.mould)
summary(SM_glm)
stipp_glm <- glm(stippling_prop~decimalLatitude*plant_genus_species+month, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAstippling)
summary(stipp_glm)
skel_glm <- glm(skel_prop~decimalLatitude*plant_genus_species+month, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAskel)
summary(skel_glm)
skel_glm <- glm(skel_prop~decimalLatitude+plant_genus_species+month, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAskel)
summary(skel_glm)
chew_glm <- glm(chew_prop~decimalLatitude*plant_genus_species+month, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAchew)
summary(chew_glm)
chew_glm <- glm(chew_prop~decimalLatitude*plant_genus_species+month+year, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAchew)
summary(chew_glm)
skel_glm <- glm(skel_prop~decimalLatitude+plant_genus_species+month+year, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAskel)
summary(skel_glm)
stipp_glm <- glm(stippling_prop~decimalLatitude*plant_genus_species+month+year, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAstippling)
summary(stipp_glm)
SM_glm <- glm(sooty.mould_prop~decimalLatitude+plant_genus_species+month+year, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAsooty.mould)
summary(SM_glm)
BM_glm <- glm(blotch.mine_prop~decimalLatitude*plant_genus_species+month+year, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAblotch.mine)
summary(BM_glm)
SMine_glm <- glm(serpentine.mine_prop~decimalLatitude*plant_genus_species+month+year, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAserpentine.mine)
summary(SMine_glm)
model <- glmer(chew_prop~decimalLatitude+month+(1|plant_genus_species), weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAchew, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
summary(model)
chew_glm <- glm(chew_prop~decimalLatitude*plant_genus_species+month+year, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAchew)
summary(chew_glm)
skel_glm <- glm(skel_prop~decimalLatitude+plant_genus_species+month+year, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAskel)
summary(skel_glm)
chew_glm <- glm(chew_prop~decimalLatitude*plant_genus_species+month+year, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAchew)
summary(chew_glm)
chew_glm <- glm(chew_prop~decimalLatitude+plant_genus_species+month+year, weights=totalboxes, family = binomial(logit),
na.action=na.omit, data=merged_noNAchew)
summary(chew_glm)
ggplot(merged, aes(x=decimalLatitude, y=leafremoved, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(VAAN, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(QUBI, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(CAOV, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
plot(merged_noNAchew$decimalLatitude, merged_noNAchew$chew_prop)
plot(merged_noNAchew$decimalLatitude, merged_noNAchew$skel_prop)
plot(merged_noNAskel$decimalLatitude, merged_noNAskel$skel_prop)
plot(merged_noNAstippling$decimalLatitude, merged_noNAstippling$stippling_prop)
plot(merged_noNAsooty.mould$decimalLatitude, merged_noNAsooty.mould$sooty.mould_prop)
plot(merged_noNAblotch.mine$decimalLatitude, merged_noNAblotch.mine$blotch.mine)
plot(merged_noNAserpentine.mine$decimalLatitude, merged_noNAserpentine.mine$blotch.mine)
plot(merged_noNAserpentine.mine$decimalLatitude, merged_noNAserpentine.mine$serpentine.mine)
ggplot(merged, aes(x=decimalLatitude, y=skel, colour=plant_genus_species)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=stippling, colour=plant_genus_species)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=serpentine.mine, colour=plant_genus_species)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=blotch.mine, colour=plant_genus_species)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=sooty.mould, colour=plant_genus_species)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=unknown.lesions, colour=plant_genus_species)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=leafremoved, colour=plant_genus_species)) + geom_point()
ggplot(DECA, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(VAAN, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(QUBI, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(CAOV, aes(x=decimalLatitude, y=leafremoved)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=skel, colour=plant_genus_species)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=skel, colour=plant_genus_species)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=stippling, colour=plant_genus_species)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=serpentine.mine, colour=plant_genus_species)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=blotch.mine, colour=plant_genus_species)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=sooty.mould, colour=plant_genus_species)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=leafremoved, colour=plant_genus_species)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=skel, colour=plant_genus_species)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=stippling, colour=plant_genus_species)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=serpentine.mine, colour=plant_genus_species)) + geom_point()
ggplot(merged, aes(x=decimalLatitude, y=blotch.mine, colour=plant_genus_species)) + geom_point()
